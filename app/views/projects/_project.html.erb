<!-- <%= check_box_tag 'project_ids[]', project.id %> -->
<h2>
	<%= link_to project.client.name, client_path(project.client_id) %>
	<%= link_to project.name, client_project_path(project.client_id, project) %>
	<span class="utility-nav">	
	<%= link_to "New Project", new_client_project_path(:client_id => project.client.id), class: "client-button" %>
	| <%= link_to "New Milestone", new_client_project_milestone_path(:client_id => project.client_id, :project_id => project.id), class: "client-button" %>
	| <%= link_to "New Asset", new_client_project_asset_path(:client_id => project.client_id, :project_id => project.id), class: "client-button" %>
	| <%= link_to "New Deliverable", new_client_project_deliverable_path(:client_id => project.client_id, :project_id => project.id), class: "client-button" %>
	| <a href="#" class="collapse client-button">Collapse</a>
	</span>

</h2>

<p>Next Milestone: <%= project.milestones.where(:complete => false).first.name if project.milestones.present? %></p>
<p>Next Asset: <%= project.assets.where(:received => false).first.name if project.assets.present? %></p>
<p>Next Deliverable: TODO</p>

<% if project.end_date? %>
	<span class="project-info">
		| Expected due date: <%= project.end_date.strftime('%m/%d/%Y') %> |
		<% if project.end_date >= DateTime.now %>upcoming: 
		<% else %>overdue: 
		<% end %>
		<strong><%= distance_of_time_in_words_to_now(project.end_date) %></strong>
	</span>
<% end %>


<div class="row">

	<ul class="nav phases">

		<% Milestone.select('distinct(phase)').each do |ph| %>
		<li class="span2">
			<a href="#<%= ph.phase %><%= project.id %>" data-target="#<%= ph.phase %><%= project.id %>" data-toggle="tab"><%= ph.phase %></a>
		</li>
		<% end %>
		<li class="span2">
			<a href="#Assets<%= project.id %>" data-target="#Assets<%= project.id %>" data-toggle="tab">Assets</a>
		</li>
		<li class="span2">
			<a href="#Deliverables<%= project.id %>" data-target="#Deliverables<%= project.id %>" data-toggle="tab">Deliverables</a>
		</li>


	</ul>

	<div class="tab-content">
		
		<!-- PHASES  -->
		<% Milestone.select('distinct(phase)').each do |ph| %>
		<div class="tab-pane" id="<%= ph.phase %><%= project.id %>">
			
			<%= render project.milestones.where('phase = "' + ph.phase + '"') %>
			
		</div>
		<% end %>

		<!-- ASSETS  -->
		<div class="tab-pane" id="Assets<%= project.id %>">
			<%= form_tag("/clients/" + project.client_id.to_s + "/projects/" + project.id.to_s + "/assets/receive/") do %>
		
			<ul class="assets">
				<%= render project.assets %>
			</ul>
			<%= submit_tag "Mark Received", class: "client-button" %>
			<% end %>
		</div>
		
		<!-- DELIVERABLES -->
		<div class="tab-pane" id="Deliverables<%= project.id %>">
			<%= form_tag("/clients/" + project.client_id.to_s + "/projects/" + project.id.to_s + "/deliverables/complete/") do %>
		
			<ul class="deliverables">
				<%= render project.deliverables %>
			</ul>
			<%= submit_tag "Mark Complete", class: "client-button" %>
			<% end %>
		
	
		</div>


	</div>

</div>
	